(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52015,       1472]
NotebookOptionsPosition[     48229,       1401]
NotebookOutlinePosition[     48701,       1419]
CellTagsIndexPosition[     48658,       1416]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 StyleBox[
  RowBox[{"<<", "EDCRGTCcode.m"}],
  FontFamily->"Courier",
  FontWeight->"Bold"]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"07fb5fb9-2064-7e45-b31d-47787b646575"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Classify\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Classify\\\", \\\"[\\\", \\\"x_\\\", \\\"]\\\"}]\\) is \
Protected.\"", 2, 0, 1, 24847074754412127024, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9573824313472233`*^9, 3.964223385262467*^9, 
  3.96849855228052*^9, 3.9684994309322433`*^9, 3.9690609157703705`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"24cfe52e-05f8-bb48-85fa-d2974a04e9d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "|", "k"}], "}"}], ">=", "0"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "k1", "|", "k2", "|", "k3", "|", "k4", "|", "t", "|", "x", "|", "y", 
       "|", "z", "|", 
       RowBox[{"t", "'"}]}], "}"}], "\[Element]", "Reals"}], ",", 
    RowBox[{"0", "<=", "w", "<=", 
     RowBox[{"2", " ", "Pi", " ", 
      SubscriptBox["r", "0"]}]}], ",", 
    RowBox[{
     SubscriptBox["r", "0"], ">", "0"}], ",", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], ">", "0"}], ",", 
    RowBox[{
     RowBox[{"rho", "[", "t", "]"}], ">", "0"}], ",", 
    RowBox[{
     RowBox[{"W", "[", "t", "]"}], ">=", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9249607696087627`*^9, 3.924960837543438*^9}, {
   3.924962992230646*^9, 3.92496304402336*^9}, {3.9251047004282894`*^9, 
   3.925104701276544*^9}, 3.925865190130493*^9, {3.9259133835584087`*^9, 
   3.9259134290115433`*^9}, {3.925913474368622*^9, 3.925913527682328*^9}, 
   3.925913588736296*^9, 3.9259136568547344`*^9, {3.9259155938105984`*^9, 
   3.925915599265291*^9}, 3.92591925142095*^9, {3.9259208276002617`*^9, 
   3.925920908258827*^9}, {3.9259216845880604`*^9, 3.925921694932072*^9}, {
   3.925922110582737*^9, 3.9259221172927513`*^9}, {3.9259222818253*^9, 
   3.925922317483507*^9}, {3.925922457050175*^9, 3.925922458949663*^9}, {
   3.925926467486101*^9, 3.9259264741468678`*^9}, {3.925926512778084*^9, 
   3.925926602976912*^9}, {3.925927235112974*^9, 3.9259273669283886`*^9}, {
   3.925927562205982*^9, 3.925927572040028*^9}, 3.9259276311681137`*^9, {
   3.925927674730898*^9, 3.9259276807852993`*^9}, {3.925927739056618*^9, 
   3.925927749439127*^9}, {3.925927857814939*^9, 3.925927865816706*^9}, {
   3.9259279090421257`*^9, 3.925927922410385*^9}, {3.9259280506620502`*^9, 
   3.925928060237055*^9}, {3.9259281422364216`*^9, 3.925928154556492*^9}, {
   3.925928246482048*^9, 3.9259282797020893`*^9}, {3.925928328480965*^9, 
   3.9259283668122826`*^9}, {3.925928615354994*^9, 3.925928616057022*^9}, {
   3.9454005934363785`*^9, 3.945400636863039*^9}, {3.945405271292654*^9, 
   3.945405279438167*^9}, {3.945405514441229*^9, 3.945405518847578*^9}, {
   3.945405575954178*^9, 3.945405608987781*^9}, {3.945405640634386*^9, 
   3.9454056466855187`*^9}, {3.945405774115652*^9, 3.945405775599849*^9}, 
   3.9454060918633003`*^9, {3.945406220029941*^9, 3.9454062721401424`*^9}, {
   3.945406308496538*^9, 3.945406328210556*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7e7aeb87-1668-2143-b744-e4994f339364"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "|", "k"}], "}"}], "\[GreaterEqual]", "0"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "k1", "|", "k2", "|", "k3", "|", "k4", "|", "t", "|", "x", "|", "y", "|",
       "z", "|", 
      SuperscriptBox["t", "\[Prime]",
       MultilineFunction->None]}], ")"}], "\[Element]", 
    TemplateBox[{},
     "Reals"]}], ",", 
   RowBox[{"0", "\[LessEqual]", "w", "\[LessEqual]", 
    RowBox[{"2", " ", "\[Pi]", " ", 
     SubscriptBox["r", "0"]}]}], ",", 
   RowBox[{
    SubscriptBox["r", "0"], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"W", "[", "t", "]"}], "\[GreaterEqual]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.957382432028228*^9, 3.964223388126227*^9, 
  3.968498558785969*^9, 3.9684994326911926`*^9, 3.9690609162196674`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"8af69517-a017-b74f-a1dc-7ac249661d73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xCoord", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "^", "2"}]}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "^", "2"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"rho", "[", "t", "]"}], "^", "2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpRules", "=", "TrigRules"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "xCoord"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9453931331242123`*^9, 3.945393134431705*^9}, {
   3.9453946890857983`*^9, 3.945394689567692*^9}, 3.9642233803420296`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"5047d803-f1c0-c74a-8482-bed90c7f507e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"rho", "[", "t", "]"}], "2"]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{1, 0, 0, 0}, {0, -$CellContext`a[$CellContext`t]^2, 0, 0}, {
     0, 0, -$CellContext`a[$CellContext`t]^2, 0}, {
     0, 0, 0, -$CellContext`rho[$CellContext`t]^2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.969060916250202*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"69643688-ca9f-d544-a853-d079c15cf5b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"d", "[", "t", "]"}], "2"], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "x", "]"}], "2"]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "y", "]"}], "2"]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"rho", "[", "t", "]"}], "2"]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[$CellContext`d[$CellContext`t]^2 - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`x]^2 - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`y]^2 - $CellContext`d[$CellContext`z]^2 \
$CellContext`rho[$CellContext`t]^2, 32]],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162522163`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"50d9752a-00ac-4c47-982a-e2e5653e96bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"]]}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"]]}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"rho", "[", "t", "]"}], "2"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{1, 0, 0, 0}, {
     0, (-1) $CellContext`a[$CellContext`t]^(-2), 0, 0}, {
     0, 0, (-1) $CellContext`a[$CellContext`t]^(-2), 0}, {
     0, 0, 0, (-1) $CellContext`rho[$CellContext`t]^(-2)}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162598457`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"01832a9a-f309-5c4f-8f6c-d176bf9fe7d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162620163`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"152c4f9f-2069-7242-958b-55a9ede12f43"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162630215`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"a85482ae-659f-0a45-9833-5203ff1a3b0a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162630215`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"e92dd5ec-5399-7045-aaa8-95fefd93aa33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162654305`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"5d45f9fb-d1c3-3f4c-9326-19ae2be6425a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609162669754`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"799c4ce9-ee7a-0047-ab7f-8ff29e09d55b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609163385334`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"864f3f2a-eb15-a042-9819-f97a184a27d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0., " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.9690609163435993`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"78ed7b88-9cf6-7e42-a5d3-2123f4437cbb"],

Cell[BoxData["\<\"All tasks completed in 0.015625 seconds\"\>"], "Print",
 CellChangeTimes->{3.957382432064569*^9, 3.964223394367047*^9, 
  3.96849855893245*^9, 3.968499434769836*^9, 3.969060916345785*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"80aa9888-1467-9642-802b-63df6d6e6ea2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"W", "[", "t", "]"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], " ", 
    SuperscriptBox["E", 
     RowBox[{
      RowBox[{"-", "I"}], " ", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{"t", "'"}], "]"}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"t", "'"}]}]}]}]}]]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.925921135238537*^9, 3.925921141921694*^9}, 
   3.9259211956887665`*^9, {3.945393040606819*^9, 3.945393056798426*^9}, 
   3.945393334436891*^9, 3.945393909250374*^9, {3.945395657313545*^9, 
   3.945395660344982*^9}, 3.9453957603357906`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"1fa71284-a3aa-4f42-9d32-95296f475609"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "t"], 
     RowBox[{
      RowBox[{"W", "[", 
       SuperscriptBox["t", "\[Prime]",
        MultilineFunction->None], "]"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["t", "\[Prime]",
        MultilineFunction->None]}]}]}]}]], 
  SqrtBox[
   RowBox[{"W", "[", "t", "]"}]]]], "Output",
 CellChangeTimes->{3.9573824324121075`*^9, 3.964223405183801*^9, 
  3.9684985590875645`*^9, 3.968499438132353*^9, 3.9690609165781517`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"a476cc21-44de-204f-baa7-b931d43d2e4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", " ", "\[Pi]"}], ")"}], "3"]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"-", "2"}], "/", "2"}]], 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    SuperscriptBox["E", 
     RowBox[{"\[ImaginaryI]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1", "*", "x"}], "+", 
        RowBox[{"k2", "*", "y"}], "+", 
        RowBox[{"k3", "*", "z"}]}], ")"}]}]], 
    RowBox[{"h", "[", "t", "]"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.922882385163646*^9, 3.922882492490116*^9}, {
   3.92288261386491*^9, 3.9228826411649265`*^9}, {3.92288268991027*^9, 
   3.922882775035841*^9}, 3.924306286783104*^9, {3.9243063661540813`*^9, 
   3.92430639144026*^9}, {3.924306421891352*^9, 3.9243064824031353`*^9}, {
   3.925865555868599*^9, 3.925865560260164*^9}, {3.925868285625585*^9, 
   3.925868298126898*^9}, 3.925868458585575*^9, 3.925868490623726*^9, {
   3.925913265324013*^9, 3.925913267052534*^9}, {3.925913346884932*^9, 
   3.9259133496780014`*^9}, {3.925988539009245*^9, 3.925988548176602*^9}, {
   3.9453956657583065`*^9, 3.94539566764144*^9}, 3.94539576296134*^9, {
   3.945406960106182*^9, 3.945406968454059*^9}, {3.964223420603641*^9, 
   3.9642234309707947`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"90613d2e-5c59-df4b-be4e-cb71f7f7e00f"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "x"}], "+", 
      RowBox[{"k2", " ", "y"}], "+", 
      RowBox[{"k3", " ", "z"}], "-", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"W", "[", 
         SuperscriptBox["t", "\[Prime]",
          MultilineFunction->None], "]"}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["t", "\[Prime]",
          MultilineFunction->None]}]}]}]}], ")"}]}]], 
  RowBox[{"4", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"3", "/", "2"}]], " ", 
   RowBox[{"a", "[", "t", "]"}], " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"rho", "[", "t", "]"}], " ", 
     RowBox[{"W", "[", "t", "]"}]}]]}]]], "Output",
 CellChangeTimes->{3.957382432590481*^9, 3.9642234419148636`*^9, 
  3.9684985591632023`*^9, 3.968499440306999*^9, 3.969060916649723*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"c69c135f-16cd-e74b-8953-967a5551d465"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Conjugate", "[", 
   RowBox[{"f", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.925913324062519*^9, 3.925913339547268*^9}, {
   3.9259289476499844`*^9, 3.925928975102569*^9}, 3.945393598100294*^9, {
   3.9453938107697315`*^9, 3.9453938191507607`*^9}, {3.945395679902828*^9, 
   3.9453956892529945`*^9}, {3.94539576588082*^9, 3.945395769628977*^9}, 
   3.9642234497418613`*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"3411a21c-d7db-9545-b62c-097a05055b90"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "x"}], "+", 
      RowBox[{"k2", " ", "y"}], "+", 
      RowBox[{"k3", " ", "z"}], "-", 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "t"], 
        RowBox[{
         RowBox[{"W", "[", 
          SuperscriptBox["t", "\[Prime]",
           MultilineFunction->None], "]"}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["t", "\[Prime]",
           MultilineFunction->None]}]}]}], "]"}]}], ")"}]}]], 
  RowBox[{"4", " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"3", "/", "2"}]], " ", 
   RowBox[{"a", "[", "t", "]"}], " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"rho", "[", "t", "]"}], " ", 
     RowBox[{"W", "[", "t", "]"}]}]]}]]], "Output",
 CellChangeTimes->{
  3.957382432667433*^9, {3.96422344594204*^9, 3.964223450778837*^9}, 
   3.9684985592385025`*^9, 3.969060916722477*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"aab021af-e76b-db4d-9a5f-c78ba01a179f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "*", 
   RowBox[{"Conjugate", "[", 
    RowBox[{"f", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "//", 
  "Simplify", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", 
    SubscriptBox["r", "0"], " ", "in", " ", "the", " ", "denominator", " ", 
    "for", " ", "the", " ", "compact", " ", "dimension", " ", "case"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.951385379626369*^9, {3.9642234679390697`*^9, 3.964223470124181*^9}, {
   3.971494088439333*^9, 
   3.9714940892162323`*^9}},ExpressionUUID->"beac32e4-cefe-e44b-ad4b-\
4eaeb19224d4"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "t"], 
        RowBox[{
         RowBox[{"W", "[", 
          SuperscriptBox["t", "\[Prime]",
           MultilineFunction->None], "]"}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["t", "\[Prime]",
           MultilineFunction->None]}]}]}], "]"}], "-", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"W", "[", 
         SuperscriptBox["t", "\[Prime]",
          MultilineFunction->None], "]"}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["t", "\[Prime]",
          MultilineFunction->None]}]}]}]}], ")"}]}]], 
  RowBox[{"16", " ", 
   SuperscriptBox["\[Pi]", "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "t", "]"}], "2"], " ", 
   RowBox[{"rho", "[", "t", "]"}], " ", 
   RowBox[{"W", "[", "t", "]"}]}]]], "Output",
 CellChangeTimes->{3.9573824327862797`*^9, 3.964223471266182*^9, 
  3.9684985593635273`*^9, 3.9690609168507366`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"9ff5de9b-faf6-1244-bb70-ae157feb3fec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"covD", "[", 
          RowBox[{"f", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"covD", "[", 
           RowBox[{"f", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"gdd", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["Grad2Norm",
           FontFamily->"Courier",
           FontWeight->"Bold"], 
          StyleBox["[",
           FontFamily->"Courier",
           FontWeight->"Bold"], 
          RowBox[{
           StyleBox[
            RowBox[{"f", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}],
            FontFamily->"Courier",
            FontWeight->"Bold"], 
           StyleBox[",",
            FontFamily->"Courier",
            FontWeight->"Bold"], 
           RowBox[{"Conjugate", "[", 
            RowBox[{"f", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
          "]"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"gdd", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}], 
        SuperscriptBox["m", "2"], 
        RowBox[{"f", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"f", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}]}], 
      StyleBox[")",
       FontFamily->"Courier",
       FontWeight->"Bold"]}], 
     StyleBox["/",
      FontFamily->"Courier",
      FontWeight->"Bold"], 
     StyleBox[
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"Im", "[", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "t"], 
           RowBox[{
            RowBox[{"W", "[", 
             SuperscriptBox["t", "\[Prime]",
              MultilineFunction->None], "]"}], 
            RowBox[{"\[DifferentialD]", 
             SuperscriptBox["t", "\[Prime]",
              MultilineFunction->None]}]}]}], "]"}]}]], 
       RowBox[{"16", " ", 
        SuperscriptBox["\[Pi]", "3"], " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"rho", "[", "t", "]"}]}]],
      FontFamily->"Courier",
      FontWeight->"Bold"]}], "//", "ComplexExpand"}], "//", "Simplify"}], "//",
   "Expand"}]], "Input",
 CellChangeTimes->{{3.945409313525787*^9, 3.945409348334254*^9}, {
   3.945409646539355*^9, 3.945409750662138*^9}, {3.945409812502915*^9, 
   3.945409825498699*^9}, {3.94540986516859*^9, 3.945409892901605*^9}, {
   3.945410137503872*^9, 3.945410206156332*^9}, {3.945410253750551*^9, 
   3.945410272303133*^9}, 3.9454113688417606`*^9, 3.945411427918667*^9, {
   3.945411538613911*^9, 3.94541160337393*^9}, {3.945412922633613*^9, 
   3.945412925976255*^9}, {3.9454129617511425`*^9, 3.9454129787955513`*^9}, {
   3.964223481972363*^9, 3.964223515459013*^9}, 3.968498564290001*^9, {
   3.968499473114897*^9, 3.968499483913856*^9}, {3.969060934985094*^9, 
   3.9690609373252907`*^9}, {3.969061055237339*^9, 3.969061062648506*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8beac1c5-921e-e441-a647-ad3900b6a1dc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["k3", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["k1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["k2", "2"], " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
   RowBox[{"W", "[", "t", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"], 
   RowBox[{"8", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["W", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "3"]}]]}]], "Output",
 CellChangeTimes->{3.968500549670735*^9, 3.969061068863001*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"308f3ee7-531a-9241-a300-67bf435a940b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"preintegrand1", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["k3", "2"], 
     RowBox[{"W", "[", "t", "]"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"rho", "[", "t", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"omega", "[", "t", "]"}], "2"]}], 
     RowBox[{"2", " ", 
      RowBox[{"W", "[", "t", "]"}]}]], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
     RowBox[{"W", "[", "t", "]"}]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"W", "[", "t", "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"rho", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["rho", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"W", "[", "t", "]"}]}]], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["rho", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"], 
     RowBox[{"8", " ", 
      RowBox[{"W", "[", "t", "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["W", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"rho", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["rho", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["W", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["W", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], 
     RowBox[{"8", " ", 
      SuperscriptBox[
       RowBox[{"W", "[", "t", "]"}], "3"]}]]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.945395432319395*^9, 3.945395453851013*^9}, {
   3.9453963074782944`*^9, 3.94539634897576*^9}, {3.94539771051408*^9, 
   3.945397725154503*^9}, 3.945410815623981*^9, 3.9454108553943214`*^9, {
   3.945413010000166*^9, 3.945413030699312*^9}, {3.9513869334461937`*^9, 
   3.951386960533813*^9}, {3.96422362805707*^9, 3.964223657992922*^9}, 
   3.968499512105753*^9, 3.968500541716286*^9, {3.969061707036007*^9, 
   3.9690617994362183`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"478ecaa6-c4e7-294f-8332-bf41497a2543"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["k3", "2"], 
   RowBox[{"W", "[", "t", "]"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"omega", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
   RowBox[{"W", "[", "t", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"], 
   RowBox[{"8", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["W", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "3"]}]]}]], "Output",
 CellChangeTimes->{{3.9685005438337197`*^9, 3.968500568574341*^9}, 
   3.9690618035517826`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"f800c54c-0e6d-6f4f-808b-2f2ef2e49ab2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"preintegrand2", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Xi]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rdd", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "4"}], "]"}], "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], "R", " ", 
            RowBox[{"gdd", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}]}]}], ")"}], "*", 
         RowBox[{"f", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "*", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"f", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "-", 
        RowBox[{"\[Xi]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gdd", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
            RowBox[{"Laplacian", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "*", 
               RowBox[{"Conjugate", "[", 
                RowBox[{"f", "[", 
                 RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
              ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "-", 
           StyleBox[
            RowBox[{
             RowBox[{"covD", "[", 
              RowBox[{"covD", "[", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"f", "[", 
                  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}],
                "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}],
            FontFamily->"Courier",
            FontWeight->"Bold"]}], 
          StyleBox[")",
           FontFamily->"Courier",
           FontWeight->"Bold"]}]}]}], 
       StyleBox[")",
        FontFamily->"Courier",
        FontWeight->"Bold"]}], 
      StyleBox["/",
       FontFamily->"Courier",
       FontWeight->"Bold"], 
      StyleBox[
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"Im", "[", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t"], 
            RowBox[{
             RowBox[{"W", "[", 
              SuperscriptBox["t", "\[Prime]",
               MultilineFunction->None], "]"}], 
             RowBox[{"\[DifferentialD]", 
              SuperscriptBox["t", "\[Prime]",
               MultilineFunction->None]}]}]}], "]"}]}]], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "3"], " ", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], " ", 
         RowBox[{"rho", "[", "t", "]"}]}]],
       FontFamily->"Courier",
       FontWeight->"Bold"]}], 
     StyleBox["//",
      FontFamily->"Courier",
      FontWeight->"Bold"], 
     StyleBox["ComplexExpand",
      FontFamily->"Courier",
      FontWeight->"Bold"]}], 
    StyleBox["//",
     FontFamily->"Courier",
     FontWeight->"Bold"], 
    StyleBox["Simplify",
     FontFamily->"Courier",
     FontWeight->"Bold"]}], 
   StyleBox["//",
    FontFamily->"Courier",
    FontWeight->"Bold"], 
   StyleBox["Expand",
    FontFamily->"Courier",
    FontWeight->"Bold"]}]}]], "Input",
 CellChangeTimes->{{3.9453972339514656`*^9, 3.94539723870058*^9}, {
  3.945397276643835*^9, 3.945397322829029*^9}, {3.94539755977755*^9, 
  3.94539759338996*^9}, {3.945398165021068*^9, 3.945398238520975*^9}, {
  3.9454111808764305`*^9, 3.94541121923876*^9}, {3.9454114674563694`*^9, 
  3.945411502433132*^9}, {3.945413044583319*^9, 3.945413098086344*^9}, {
  3.945413175816332*^9, 3.945413190058678*^9}, {3.951386728442007*^9, 
  3.951386763370289*^9}, {3.95138685139626*^9, 3.9513868545648174`*^9}, {
  3.964223666482992*^9, 3.9642236920446663`*^9}, {3.9684995529751015`*^9, 
  3.968499567246432*^9}, {3.9690618325103664`*^9, 3.9690618461980896`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"5cfd5a6e-10b7-4844-a5f1-c1a90b16af6a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["rho", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"W", "[", "t", "]"}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["W", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "3"]], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"W", "[", "t", "]"}]], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "2"]]}]], "Output",
 CellChangeTimes->{3.957382434228046*^9, 3.964223695386341*^9, 
  3.968499579488163*^9, 3.968500762316*^9, 3.969061904257347*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"0e6c215d-274f-e444-a80e-3cc796abb4d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"preintegrand", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{"preintegrand1", "[", "t", "]"}], "+", 
   RowBox[{"preintegrand2", "[", "t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.945398246534191*^9, 3.945398266587969*^9}, {
  3.945413221621834*^9, 3.945413223798153*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"51efb854-8e02-5d4d-b834-61ace3d1efd8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["k3", "2"], 
   RowBox[{"W", "[", "t", "]"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"omega", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
   RowBox[{"W", "[", "t", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"], 
   RowBox[{"8", " ", 
    RowBox[{"W", "[", "t", "]"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["rho", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"W", "[", "t", "]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["W", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"W", "[", "t", "]"}], "3"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["W", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "3"]], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    RowBox[{"rho", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["rho", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"W", "[", "t", "]"}]], "-", 
  FractionBox[
   RowBox[{"\[Xi]", " ", 
    SuperscriptBox[
     RowBox[{"rho", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["W", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   SuperscriptBox[
    RowBox[{"W", "[", "t", "]"}], "2"]]}]], "Output",
 CellChangeTimes->{3.957382434302969*^9, 3.9642237032401047`*^9, 
  3.9684995937467976`*^9, 3.9685007681323*^9, 3.9690619102001877`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"7bde362f-ff63-dc49-a753-2656b36a97a6"]
}, Open  ]]
},
WindowSize->{1268, 720},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"291b974a-ff0a-cd4a-b347-2bf3b4215338"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 195, 5, 27, "Input",ExpressionUUID->"07fb5fb9-2064-7e45-b31d-47787b646575"],
Cell[778, 29, 525, 11, 28, "Message",ExpressionUUID->"24cfe52e-05f8-bb48-85fa-d2974a04e9d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1340, 45, 2594, 48, 29, "Input",ExpressionUUID->"7e7aeb87-1668-2143-b744-e4994f339364"],
Cell[3937, 95, 1042, 28, 33, "Output",ExpressionUUID->"8af69517-a017-b74f-a1dc-7ac249661d73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5016, 128, 1245, 35, 86, "Input",ExpressionUUID->"5047d803-f1c0-c74a-8482-bed90c7f507e"],
Cell[CellGroupData[{
Cell[6286, 167, 1402, 38, 74, "Print",ExpressionUUID->"69643688-ca9f-d544-a853-d079c15cf5b1"],
Cell[7691, 207, 1242, 33, 23, "Print",ExpressionUUID->"50d9752a-00ac-4c47-982a-e2e5653e96bb"],
Cell[8936, 242, 1521, 42, 99, "Print",ExpressionUUID->"01832a9a-f309-5c4f-8f6c-d176bf9fe7d1"],
Cell[10460, 286, 458, 10, 22, "Print",ExpressionUUID->"152c4f9f-2069-7242-958b-55a9ede12f43"],
Cell[10921, 298, 462, 10, 22, "Print",ExpressionUUID->"a85482ae-659f-0a45-9833-5203ff1a3b0a"],
Cell[11386, 310, 478, 10, 22, "Print",ExpressionUUID->"e92dd5ec-5399-7045-aaa8-95fefd93aa33"],
Cell[11867, 322, 478, 10, 22, "Print",ExpressionUUID->"5d45f9fb-d1c3-3f4c-9326-19ae2be6425a"],
Cell[12348, 334, 462, 10, 22, "Print",ExpressionUUID->"799c4ce9-ee7a-0047-ab7f-8ff29e09d55b"],
Cell[12813, 346, 460, 10, 22, "Print",ExpressionUUID->"864f3f2a-eb15-a042-9819-f97a184a27d6"],
Cell[13276, 358, 468, 10, 22, "Print",ExpressionUUID->"78ed7b88-9cf6-7e42-a5d3-2123f4437cbb"],
Cell[13747, 370, 309, 5, 22, "Print",ExpressionUUID->"80aa9888-1467-9642-802b-63df6d6e6ea2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14105, 381, 894, 24, 32, "Input",ExpressionUUID->"1fa71284-a3aa-4f42-9d32-95296f475609"],
Cell[15002, 407, 693, 18, 59, "Output",ExpressionUUID->"a476cc21-44de-204f-baa7-b931d43d2e4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15732, 430, 1691, 41, 32, "Input",ExpressionUUID->"90613d2e-5c59-df4b-be4e-cb71f7f7e00f"],
Cell[17426, 473, 1031, 28, 59, "Output",ExpressionUUID->"c69c135f-16cd-e74b-8953-967a5551d465"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18494, 506, 567, 11, 28, "Input",ExpressionUUID->"3411a21c-d7db-9545-b62c-097a05055b90"],
Cell[19064, 519, 1103, 31, 59, "Output",ExpressionUUID->"aab021af-e76b-db4d-9a5f-c78ba01a179f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20204, 555, 694, 18, 28, "Input",ExpressionUUID->"beac32e4-cefe-e44b-ad4b-4eaeb19224d4"],
Cell[20901, 575, 1237, 33, 58, "Output",ExpressionUUID->"9ff5de9b-faf6-1244-bb70-ae157feb3fec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22175, 613, 3613, 94, 92, "Input",ExpressionUUID->"8beac1c5-921e-e441-a647-ad3900b6a1dc"],
Cell[25791, 709, 3226, 105, 97, "Output",ExpressionUUID->"308f3ee7-531a-9241-a300-67bf435a940b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29054, 819, 3363, 96, 71, "Input",ExpressionUUID->"478ecaa6-c4e7-294f-8332-bf41497a2543"],
Cell[32420, 917, 2744, 88, 53, "Output",ExpressionUUID->"f800c54c-0e6d-6f4f-808b-2f2ef2e49ab2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35201, 1010, 4259, 115, 134, "Input",ExpressionUUID->"5cfd5a6e-10b7-4844-a5f1-c1a90b16af6a"],
Cell[39463, 1127, 2888, 86, 53, "Output",ExpressionUUID->"0e6c215d-274f-e444-a80e-3cc796abb4d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42388, 1218, 388, 8, 28, "Input",ExpressionUUID->"51efb854-8e02-5d4d-b834-61ace3d1efd8"],
Cell[42779, 1228, 5434, 170, 97, "Output",ExpressionUUID->"7bde362f-ff63-dc49-a753-2656b36a97a6"]
}, Open  ]]
}
]
*)

